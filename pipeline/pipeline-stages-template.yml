parameters:
  - name: vmImageName
    type:
      string
      # todo

stages:
  - stage: Build
    displayName: Build image
    jobs:
      - job: Build
        displayName: Build
        pool:
          vmImage: ${{ parameters.vmImageName }}
        steps:
          - task: Docker@2
            displayName: Build and Push an image to container registry
            inputs:
              command: buildAndPush
              repository: ${{ parameters.imageRepository }}
              dockerfile: ${{ parameters.dockerfilePath }}
              containerRegistry: ${{ parameters.dockerRegistryServiceConnection }}
              tags: ${{ parameters.tag }}
